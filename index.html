<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <!-- 修正視圖設定：移除 maximum-scale 限制，讓手機端可以自由縮放網頁 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R6 Callout Guide - 戰術報位圖</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Oswald:wght@400;700&family=Noto+Sans+TC:wght@400;700&display=swap');

        :root {
            --r6-yellow: #ffb400;
            --r6-dark: #121212;
            --r6-card: #1e1e1e;
        }

        body {
            background-color: var(--r6-dark);
            color: #ffffff;
            font-family: 'Noto Sans TC', 'Oswald', sans-serif;
            margin: 0;
            overflow-x: hidden;
        }

        .map-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid #333;
        }

        .map-card:hover {
            transform: translateY(-5px);
            border-color: var(--r6-yellow);
            box-shadow: 0 10px 20px rgba(255, 180, 0, 0.2);
        }

        .tab-btn.active {
            background-color: var(--r6-yellow);
            color: black;
            font-weight: bold;
        }

        /* 預設容器樣式：手機端使用 auto 確保捲動流暢 */
        .image-container {
            background-image: radial-gradient(#333 1px, transparent 1px);
            background-size: 20px 20px;
            position: relative;
            overflow: hidden;
            touch-action: auto; 
        }
        
        /* 僅在 PC 端顯示 grab 手勢圖示 */
        .is-pc .image-container {
            cursor: grab;
            touch-action: none; /* PC 端縮放時禁止預設行為 */
        }
        
        .is-pc .image-container:active {
            cursor: grabbing;
        }

        #callout-image {
            transition: transform 0.1s ease-out, opacity 0.3s ease;
            transform-origin: center;
            user-select: none;
            -webkit-user-drag: none;
            will-change: transform;
        }

        .fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 隱藏捲動條但保有功能 */
        #floor-tabs::-webkit-scrollbar {
            display: none;
        }
    </style>
</head>
<body>

    <!-- 導覽列 -->
    <nav class="sticky top-0 z-50 bg-black/80 backdrop-blur-md border-b border-white/10 p-4">
        <div class="max-w-[95%] mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold tracking-tighter text-white flex items-center gap-2 cursor-pointer" onclick="showHome()">
                <span class="bg-yellow-500 text-black px-2 py-0.5 rounded">R6</span> CALLOUTS中文版
            </h1>
            <div id="nav-info" class="hidden text-gray-400 text-sm md:text-base">
                正在瀏覽：<span id="current-map-name" class="text-yellow-500 font-bold"></span>
            </div>
        </div>
    </nav>

    <!-- 首頁：地圖選擇 -->
    <main id="home-view" class="max-w-[95%] mx-auto p-6 md:p-12 fade-in">
        <div class="mb-10">
            <h2 class="text-4xl font-bold mb-4">地圖選擇</h2>
            <p class="text-gray-400">請選擇一張地圖來查看詳細的樓層報位名稱。</p>
        </div>

        <div id="map-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            <!-- 地圖卡片將由 JS 動態生成 -->
        </div>
    </main>

    <!-- 詳細頁：地圖報位圖 -->
    <main id="detail-view" class="hidden max-w-[95%] mx-auto p-4 md:p-8 fade-in">
        <button onclick="showHome()" class="mb-6 flex items-center gap-2 text-gray-400 hover:text-white transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
            </svg>
            返回列表
        </button>

        <div class="flex flex-col lg:flex-row gap-8">
            <!-- 左側：樓層選擇 -->
            <div class="w-full lg:w-1/4">
                <h2 id="detail-title" class="text-4xl md:text-5xl font-bold mb-6 text-yellow-500 uppercase tracking-tight">地圖名稱</h2>
                <div class="bg-neutral-900 rounded-xl p-4 border border-white/5">
                    <p class="text-sm text-gray-400 mb-4 uppercase tracking-widest font-bold">樓層選擇</p>
                    <div id="floor-tabs" class="flex flex-row lg:flex-col gap-2 overflow-x-auto pb-2 lg:pb-0">
                        <!-- 樓層按鈕由 JS 生成 -->
                    </div>
                </div>
            </div>

            <!-- 右側：報位圖展示 -->
            <div class="w-full lg:w-3/4">
                <div id="zoom-area" class="image-container bg-neutral-900 rounded-2xl border border-white/10 overflow-hidden relative min-h-[400px] xl:h-[calc(100vh-220px)] flex items-center justify-center">
                    <img id="callout-image" src="" alt="樓層報位圖" class="max-w-full max-h-full w-auto h-auto object-contain">
                    
                    <!-- 縮放控制器 (僅 PC 端顯示) -->
                    <div id="reset-btn-container" class="absolute bottom-4 right-4 hidden md:block">
                        <button onclick="resetZoom()" class="bg-black/60 hover:bg-yellow-500 hover:text-black text-white px-3 py-2 rounded-lg backdrop-blur-md text-sm transition-all border border-white/10">
                            重設縮放
                        </button>
                    </div>

                    <!-- 載入中 -->
                    <div id="image-loader" class="absolute inset-0 flex items-center justify-center bg-black/50 hidden">
                        <div class="w-10 h-10 border-4 border-yellow-500 border-t-transparent rounded-full animate-spin"></div>
                    </div>
                </div>
                <div class="mt-4 flex flex-col sm:flex-row justify-between items-start sm:items-center text-gray-500 text-xs md:text-sm gap-4">
                    <span id="floor-label">樓層：無</span>
                    <span class="flex items-center gap-4">
                        <!-- 手機端提示 -->
                        <span class="flex md:hidden text-gray-400">手機端可直接雙指縮放網頁</span>
                        <!-- PC 端提示 -->
                        <span class="hidden md:flex items-center gap-4">
                            <span class="flex items-center gap-1">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 8v8"/><path d="M8 12h8"/></svg>
                                滾輪縮放 (PC)
                            </span>
                            <span class="flex items-center gap-1">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-3 3-3-3"/><path d="m15 6-3-3-3 3"/><path d="m18 15 3-3-3-3"/><path d="m6 15-3-3 3-3"/></svg>
                                拖曳平移 (PC)
                            </span>
                        </span>
                    </span>
                </div>
            </div>
        </div>
    </main>

    <footer class="mt-20 p-10 border-t border-white/5 text-center text-gray-600">
        <p>&copy; 2026 R6 Callout Helper. Credited by ShaZ. Made by Tyrfing.</p>
    </footer>

    <script>
        const MAP_DATA = [
            {
                id: 'consulate',
                name: '領事館 (Consulate)',
                thumbnail: 'thumbnail/consulate.png',
                floors: [
                    { label: '2F', img: 'callout/consulate2.jpg' },
                    { label: '1F', img: 'callout/consulate1.jpg' },
                    { label: 'B1', img: 'callout/consulate-1.jpg' }
                ]
            },
            {
                id: 'lair',
                name: '賊窩 (Lair)',
                thumbnail: 'thumbnail/lair.png',
                floors: [
                    { label: '2F', img: 'callout/lair2.jpg' },
                    { label: '1F', img: 'callout/lair1.jpg' },
                    { label: 'B1', img: 'callout/lair-1.jpg' }
                ]
            },
            {
                id: 'clubhouse',
                name: '俱樂部 (Clubhouse)',
                thumbnail: 'thumbnail/clubhouse.png',
                floors: [
                    { label: '2F', img: 'callout/clubhouse2test.jpg' },
                    { label: '1F', img: 'callout/clubhouse1.jpg' },
                    { label: 'B1', img: 'callout/clubhouse-1.jpg' }
                ]
            },
            {
                id: 'theme park',
                name: '主題樂園 (Theme Park)',
                thumbnail: 'thumbnail/theme park.png',
                floors: [
                    { label: '2F', img: 'callout/themepark2.jpg' },
                    { label: '1F', img: 'callout/themepark1.jpg' }
                ]
            },
            {
                id: 'skyscraper',
                name: '摩天大樓 (Skyscraper)',
                thumbnail: 'thumbnail/skyscraper.png',
                floors: [
                    { label: '2F', img: 'callout/skyscraper2.jpg' },
                    { label: '1F', img: 'callout/skyscraper1.jpg' }
                ]
            },
            {
                id: 'chalet',
                name: '木屋 (Chalet)',
                thumbnail: 'thumbnail/chalet.png',
                floors: [
                    { label: '2F', img: 'callout/chalet2.jpg' },
                    { label: '1F', img: 'callout/chalet1.jpg' },
                    { label: 'B1', img: 'callout/chalet-1.jpg' }
                ]
            },
            {
                id: 'kanal',
                name: '運河 (Kanal)',
                thumbnail: 'thumbnail/kanal.png',
                floors: [
                    { label: '2F', img: 'callout/kanal2.jpg' },
                    { label: '1F', img: 'callout/kanal1.jpg' },
                    { label: 'B1', img: 'callout/kanal-1.jpg' }
                ]
            },
            {
                id: 'oregon',
                name: '奧勒岡 (Oregon)',
                thumbnail: 'thumbnail/oregon.png',
                floors: [
                    { label: '2F', img: 'callout/oregon2.jpg' },
                    { label: '1F', img: 'callout/oregon1.jpg' },
                    { label: 'B1', img: 'callout/oregon-1.jpg' }
                ]
            },
            {
                id: 'nighthaven labs',
                name: '實驗室 (Nighthaven Labs)',
                thumbnail: 'thumbnail/nighthaven.png',
                floors: [
                    { label: '2F', img: 'callout/nighthaven2.jpg' },
                    { label: '1F', img: 'callout/nighthaven1.jpg' },
                    { label: 'B1', img: 'callout/nighthaven-1.jpg' }
                ]
            },
            {
                id: 'coastline',
                name: '海岸線 (Coastline)',
                thumbnail: 'thumbnail/coastline.png',
                floors: [
                    { label: '2F', img: 'callout/coastline2.jpg' },
                    { label: '1F', img: 'callout/coastline1.jpg' }
                ]
            },
            {
                id: 'border',
                name: '邊境 (Border)',
                thumbnail: 'thumbnail/border.png',
                floors: [
                    { label: '2F', img: 'callout/border2.jpg' },
                    { label: '1F', img: 'callout/border1.jpg' }
                ]
            },
            {
                id: 'kafe',
                name: '咖啡館 (Kafe)',
                thumbnail: 'thumbnail/kafe.png',
                floors: [
                    { label: '3F', img: 'callout/kafe3.jpg' },
                    { label: '2F', img: 'callout/kafe2.jpg' },
                    { label: '1F', img: 'callout/kafe1.jpg' }
                ]
            },
            {
                id: 'fortress',
                name: '要塞 (Fortress)',
                thumbnail: 'thumbnail/fortress.png',
                floors: [
                    { label: '2F', img: 'callout/fortress2.jpg' },
                    { label: '1F', img: 'callout/fortress1.jpg' }
                ]
            },
            {
                id: 'bank',
                name: '銀行 (Bank) 待上傳',
                thumbnail: 'thumbnail/bank.png',
                floors: [
                    { label: '2F', img: 'https://placehold.co/1200x800/1e1e1e/ffb400?text=Bank+2F+Callouts' },
                    { label: '1F', img: 'https://placehold.co/1200x800/1e1e1e/ffb400?text=Bank+1F+Callouts' },
                    { label: 'B1', img: 'https://placehold.co/1200x800/1e1e1e/ffb400?text=Bank+B1+Callouts' }
                ]
            },
            {
                id: 'outback',
                name: '荒漠 (Outback) 待上傳',
                thumbnail: 'thumbnail/outback.png',
                floors: [
                    { label: '2F', img: 'https://placehold.co/1200x800/1e1e1e/ffb400?text=Outback+2F+Callouts' },
                    { label: '1F', img: 'https://placehold.co/1200x800/1e1e1e/ffb400?text=Outback+1F+Callouts' },
                    { label: 'B1', img: 'https://placehold.co/1200x800/1e1e1e/ffb400?text=Outback+B1+Callouts' }
                ]
            },
            {
                id: 'villa',
                name: '別墅 (Villa) 待上傳',
                thumbnail: 'thumbnail/villa.png',
                floors: [
                    { label: '2F', img: 'https://placehold.co/1200x800/1e1e1e/ffb400?text=Villa+2F+Callouts' },
                    { label: '1F', img: 'https://placehold.co/1200x800/1e1e1e/ffb400?text=Villa+1F+Callouts' },
                    { label: 'B1', img: 'https://placehold.co/1200x800/1e1e1e/ffb400?text=Villa+B1+Callouts' }
                ]
            }
        ];

        let currentMap = null;
        let zoomState = { scale: 1, translateX: 0, translateY: 0, isDragging: false, startX: 0, startY: 0 };

        // 偵測是否為觸控裝置 (僅供樣式區分)
        const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;

        function initHome() {
            if (!isTouchDevice) document.body.classList.add('is-pc');
            const grid = document.getElementById('map-grid');
            grid.innerHTML = '';
            
            MAP_DATA.forEach(map => {
                const card = document.createElement('div');
                card.className = 'map-card bg-neutral-900 rounded-xl overflow-hidden cursor-pointer group';
                card.onclick = () => openMap(map.id);
                
                card.innerHTML = `
                    <div class="relative h-48 overflow-hidden hidden md:block">
                        <img src="${map.thumbnail}" alt="${map.name}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500 opacity-90 group-hover:opacity-100">
                        <div class="absolute inset-0 bg-gradient-to-t from-black to-transparent opacity-80"></div>
                    </div>
                    <div class="p-5">
                        <h3 class="text-xl font-bold group-hover:text-yellow-500 transition-colors">${map.name}</h3>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function openMap(mapId) {
            currentMap = MAP_DATA.find(m => m.id === mapId);
            if (!currentMap) return;

            resetZoom();
            document.getElementById('home-view').classList.add('hidden');
            document.getElementById('detail-view').classList.remove('hidden');
            document.getElementById('nav-info').classList.remove('hidden');
            document.getElementById('current-map-name').innerText = currentMap.name;
            document.getElementById('detail-title').innerText = currentMap.name;

            const tabContainer = document.getElementById('floor-tabs');
            tabContainer.innerHTML = '';
            currentMap.floors.forEach((floor, index) => {
                const btn = document.createElement('button');
                btn.className = `tab-btn p-3 rounded-lg text-left transition-all whitespace-nowrap lg:whitespace-normal ${index === 0 ? 'active' : 'bg-white/5 hover:bg-white/10 text-gray-300'}`;
                btn.innerText = floor.label;
                btn.onclick = () => selectFloor(index, btn);
                tabContainer.appendChild(btn);
            });

            selectFloor(0);
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function selectFloor(index, btnElement) {
            const floor = currentMap.floors[index];
            const img = document.getElementById('callout-image');
            const loader = document.getElementById('image-loader');
            const label = document.getElementById('floor-label');

            resetZoom(); 
            if (btnElement) {
                document.querySelectorAll('.tab-btn').forEach(b => {
                    b.classList.remove('active', 'bg-yellow-500', 'text-black');
                    b.classList.add('bg-white/5', 'text-gray-300');
                });
                btnElement.classList.add('active');
            }

            loader.classList.remove('hidden');
            img.style.opacity = '0.3';
            img.onload = () => { img.style.opacity = '1'; loader.classList.add('hidden'); };
            img.src = floor.img;
            label.innerText = `樓層：${floor.label}`;
        }

        function showHome() {
            document.getElementById('home-view').classList.remove('hidden');
            document.getElementById('detail-view').classList.add('hidden');
            document.getElementById('nav-info').classList.add('hidden');
            resetZoom();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        const zoomArea = document.getElementById('zoom-area');
        const zoomImage = document.getElementById('callout-image');

        function updateImageTransform() {
            zoomImage.style.transform = `translate(${zoomState.translateX}px, ${zoomState.translateY}px) scale(${zoomState.scale})`;
        }

        function resetZoom() {
            zoomState = { scale: 1, translateX: 0, translateY: 0, isDragging: false, startX: 0, startY: 0 };
            updateImageTransform();
        }

        /**
         * 桌面端 PC 專屬邏輯 (滑鼠滾輪與拖曳)
         */
        if (!isTouchDevice) {
            zoomArea.addEventListener('wheel', (e) => {
                e.preventDefault();
                const delta = e.deltaY > 0 ? -0.15 : 0.15;
                const newScale = Math.min(Math.max(zoomState.scale + delta, 1), 5);
                if (newScale !== zoomState.scale) {
                    zoomState.scale = newScale;
                    if (zoomState.scale === 1) { zoomState.translateX = 0; zoomState.translateY = 0; }
                    updateImageTransform();
                }
            }, { passive: false });

            zoomArea.addEventListener('mousedown', (e) => {
                if (zoomState.scale > 1) {
                    zoomState.isDragging = true;
                    zoomState.startX = e.clientX - zoomState.translateX;
                    zoomState.startY = e.clientY - zoomState.translateY;
                }
            });

            window.addEventListener('mousemove', (e) => {
                if (zoomState.isDragging && zoomState.scale > 1) {
                    zoomState.translateX = e.clientX - zoomState.startX;
                    zoomState.translateY = e.clientY - zoomState.startY;
                    updateImageTransform();
                }
            });

            window.addEventListener('mouseup', () => { zoomState.isDragging = false; });
        }

        window.onload = initHome;
    </script>
</body>
</html>











